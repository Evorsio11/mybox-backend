{
  "info": {
    "_postman_id": "000a6f1c-b798-4336-9c9a-76291da84ef7",
    "name": "MyBox API",
    "description": "MyBox 云存储系统 API 接口集合 - 基于 OpenAPI 3.1.0 自动生成",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "用户认证",
      "item": [
        {
          "name": "用户注册",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"testuser\",\n    \"email\": \"test@example.com\",\n    \"password\": \"Test123\",\n    \"deviceInfo\": {\n        \"deviceId\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"deviceName\": \"Test Device\",\n        \"deviceType\": \"DESKTOP\",\n        \"osName\": \"Windows\",\n        \"osVersion\": \"10\"\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "register"
              ]
            },
            "description": "注册新用户"
          },
          "response": []
        },
        {
          "name": "用户登录",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data) {",
                  "        pm.environment.set(\"AccessToken\", response.data.accessToken);",
                  "        pm.environment.set(\"RefreshToken\", response.data.refreshToken);",
                  "        if (response.data.deviceToken) {",
                  "            pm.environment.set(\"DeviceToken\", response.data.deviceToken);",
                  "        }",
                  "        console.log(\"登录成功，Token 已保存到环境变量\");",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"{{devUserName}}\",\n    \"password\": \"{{devUserPassword}}\",\n    \"deviceInfo\": {\n        \"deviceId\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"deviceName\": \"Test Device\",\n        \"deviceType\": \"DESKTOP\",\n        \"osName\": \"Windows\",\n        \"osVersion\": \"10\"\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "login"
              ]
            },
            "description": "用户登录并获取访问令牌"
          },
          "response": []
        },
        {
          "name": "刷新令牌",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data) {",
                  "        pm.environment.set(\"AccessToken\", response.data.accessToken);",
                  "        pm.environment.set(\"RefreshToken\", response.data.refreshToken);",
                  "        console.log(\"令牌刷新成功\");",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refreshToken\": \"{{RefreshToken}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/refresh",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "auth",
                "refresh"
              ]
            },
            "description": "使用刷新令牌获取新的访问令牌"
          },
          "response": []
        }
      ],
      "description": "用户认证相关接口"
    },
    {
      "name": "用户管理",
      "item": [
        {
          "name": "获取当前用户信息",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users",
                "me"
              ]
            },
            "description": "获取当前登录用户的详细信息"
          },
          "response": []
        }
      ],
      "description": "用户管理相关接口"
    },
    {
      "name": "文件管理",
      "item": [
        {
          "name": "列出文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/files",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files"
              ]
            },
            "description": "获取当前用户的文件列表"
          },
          "response": []
        },
        {
          "name": "列出已删除文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/files/deleted",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "deleted"
              ]
            },
            "description": "获取已删除的文件列表"
          },
          "response": []
        },
        {
          "name": "上传文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/upload",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "upload"
              ]
            },
            "description": "上传一个或多个文件"
          },
          "response": []
        },
        {
          "name": "下载文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"fileId\": \"{{fileId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/download",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "download"
              ]
            },
            "description": "下载指定文件"
          },
          "response": []
        },
        {
          "name": "删除文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"fileId\": \"{{fileId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/delete",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "delete"
              ]
            },
            "description": "删除指定文件（软删除）"
          },
          "response": []
        },
        {
          "name": "恢复文件",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"fileId\": \"{{fileId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/restore",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "restore"
              ]
            },
            "description": "恢复已删除的文件"
          },
          "response": []
        },
        {
          "name": "获取文件配置",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/files/config",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "config"
              ]
            },
            "description": "获取文件系统配置（所有认证用户可访问）"
          },
          "response": []
        },
        {
          "name": "更新文件配置",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"storage\": {\n        \"maxFileSizeBytes\": 104857600,\n        \"maxTotalSizeBytes\": 1073741824,\n        \"retentionDays\": 30,\n        \"tempDir\": \"/tmp/mybox\"\n    },\n    \"upload\": {\n        \"types\": {\n            \"allowAll\": false,\n            \"allowedExtensions\": [\"jpg\", \"png\", \"pdf\", \"doc\", \"docx\"],\n            \"allowedContentTypes\": [\"image/jpeg\", \"image/png\", \"application/pdf\"]\n        },\n        \"chunk\": {\n            \"enabled\": true,\n            \"minSizeBytes\": 10485760,\n            \"chunkSizeBytes\": 5242880,\n            \"enableConcurrent\": true,\n            \"maxConcurrent\": 3,\n            \"enableDeduplication\": true,\n            \"deduplicationStrategy\": \"SHA256\",\n            \"sessionTimeoutHours\": 24,\n            \"maxRetry\": 3,\n            \"retryDelaySeconds\": 1,\n            \"cleanupExpired\": true,\n            \"cleanupIntervalHours\": 1\n        }\n    },\n    \"download\": {\n        \"enableRateLimit\": false,\n        \"maxBytesPerSecondBytes\": 0\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/config",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "config"
              ]
            },
            "description": "更新文件系统配置（仅 ADMIN 用户可访问）"
          },
          "response": []
        }
      ],
      "description": "文件管理相关接口"
    },
    {
      "name": "分片上传",
      "item": [
        {
          "name": "初始化分片上传",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data) {",
                  "        pm.environment.set(\"uploadId\", response.data.uploadId);",
                  "        pm.environment.set(\"chunkSize\", response.data.chunkSize);",
                  "        pm.environment.set(\"totalChunks\", response.data.totalChunks);",
                  "        console.log(\"上传初始化成功，uploadId:\", response.data.uploadId);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"originalFileName\": \"large-file.zip\",\n    \"fileSize\": 52428800,\n    \"contentType\": \"application/zip\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/init",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "init"
              ]
            },
            "description": "初始化分片上传会话"
          },
          "response": []
        },
        {
          "name": "上传分片",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "uploadId",
                  "value": "{{uploadId}}",
                  "type": "text"
                },
                {
                  "key": "chunkNumber",
                  "value": "1",
                  "type": "text"
                },
                {
                  "key": "file",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/upload",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "upload"
              ]
            },
            "description": "上传单个文件分片"
          },
          "response": []
        },
        {
          "name": "合并分片",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"uploadId\": \"{{uploadId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/merge",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "merge"
              ]
            },
            "description": "合并所有已上传的分片"
          },
          "response": []
        },
        {
          "name": "恢复上传",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/resume/{{uploadId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "resume",
                "{{uploadId}}"
              ]
            },
            "description": "获取上传进度，用于恢复中断的上传"
          },
          "response": []
        },
        {
          "name": "获取上传进度",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/progress/{{uploadId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "progress",
                "{{uploadId}}"
              ]
            },
            "description": "获取当前上传进度"
          },
          "response": []
        },
        {
          "name": "取消上传",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{AccessToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"uploadId\": \"{{uploadId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/files/chunk/cancel",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "files",
                "chunk",
                "cancel"
              ]
            },
            "description": "取消分片上传会话"
          },
          "response": []
        }
      ],
      "description": "分片上传相关接口"
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    }
  ]
}
